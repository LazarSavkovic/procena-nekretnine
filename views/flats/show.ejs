<% layout("layouts/boilerplate") %>

    <div class="row">
        <div class="col-xl-6 offset-xl-3 col-lg-8 offset-lg-2 col-10 offset-1 panel glass d-flex p-0">
            <div class="sidebar">
                <div class="user">
                    <img src="/images/avatar.png" class="avatar" alt="">
                    <h3 class="username">
                        <%=username%>
                    </h3>
                    <p class="member">Clan</p>
                </div>
                <div class="links">
                    <div class="link"><a href="/flats/new"><img src="/images/house.svg" class="house-svg" alt=""> Nova
                            nekretnina</a></div>
                    <div class="link"><a href="/flats"><img src="/images/houses.svg" class="houses-svg" alt=""> Moje
                            nekretnine</a></div>
                </div>
            </div>
            <div class="property p-0">
                <div class="preloader"></div>
                <div class="card mb-3">
                    <img src="<%= flat.image %>" alt="" class="card-img-top">
                    <div class="card-body">
                        <h3 class="card-title">
                            <%= flat.title %>
                        </h3>
                    </div>
                    <ul class="list-group list-group-flush glass">
                        <li class="list-group-item text-muted">Procenjena vrednost: <b>
                                <%= flat.value %> â‚¬
                            </b></li>
                        <li class="list-group-item text-muted">Opis: <%= flat.short_description%>
                        </li>
                        <li class="list-group-item text-muted">Adresa: <%= flat.location %>
                        </li>
                        <li class="list-group-item text-muted">Povrsina: <%= flat.sq_mt %>
                        </li>
                        <li class="list-group-item text-muted">Broj soba: <%= flat.rooms %>
                        </li>
                    </ul>
                    <div class="card-body pt-0">
                        <div class="mb-3" id="map"></div>
                        <div class="buttons d-flex flex-row">
                            <a class="card-link btn btn-secondary flex-grow-1 me-1 col-6"
                                href="/flats/<%=flat._id%>/edit">Izmeni sadrzaj</a>

                            <form class="d-inline flex-grow-1 col-6" action="/flats/<%=flat._id%>?_method=DELETE"
                                method="POST"><button class="btn btn-danger col-12">Izbrisi
                                    stan</button>
                            </form>
                        </div>
                    </div>
                    <div class="card-footer text-muted">2 days ago</div>
                </div>

            </div>
        </div>
        <div class="oval1"></div>
        <div class="oval2"></div>
        <div class="oval3"></div>
        <div class="oval4"></div>
    </div>
    <script>
        const mapToken = "<%-process.env.MAPBOX_TOKEN%>";
        const flat = <%- JSON.stringify(flat) %>;
        const apts = <%- JSON.stringify(apts) %>;
    </script>
    <script src="/javascripts/showPageMap.js"></script>

    <script>

        const preloader = document.querySelector(".preloader");
        const card = document.querySelector(".card");
        card.style.display = "none";

        window.addEventListener("load", function () {
            preloader.style.display = "none";
            card.style.display = "flex";
        })
    </script>